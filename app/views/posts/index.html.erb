<div class="columns">
  <div class="column is-3"></div>
  <div class="column is-6">
    <div class="is-flex is-justify-content-space-between">
      <h1 class="title">Home</h1>
      <button class="button toggle-modal" aria-control="new_post">New Post</button>
    </div>
    <div class="modal" id="new_post">
      <div class="modal-background toggle-modal" aria-control="new_post"></div>
      <div class="modal-content">
        <div class="box">
          <p class="title is-4">New Post</p>
          <%= render "posts/form", post: Post.new %>
        </div>
      </div>
      <button class="modal-close is-large toggle-modal" aria-control="new_post"></button>
    </div>
    <div class="card p-5">
      <% @posts.each do |post| %>
        <div>
          <div class="is-flex">
            <div><strong><%= post.user.username %></strong></div>
          </div>
          <div class="mt-1">
            <%= post.body%>
            <div class="flex">
              <%= link_to favorite_path(post.id), method: :post, remote: :true do %>
                <i class="material-icons favme <%if Favorite.exists?(user_id: current_user.id, post_id: post.id)%> active <%end%>">favorite</i>
              <% end %>
              <i class="material-icons comment toggle-modal" aria-control="comments<%=post.id%>">chat_bubble</i>
              <div class="modal" id="comments<%=post.id%>">
                <div class="modal-background toggle-modal" aria-control="comments<%=post.id%>"></div>
                <div class="modal-content">
                  <div class="box">
                    <%= render "comments/form", comment: Comment.new, post_id: post.id %>
                    <br>
                    <% post.comments.limit(3).each do |comment| %>
                      <div class="is-flex">
                        <div class="mb-2"> <strong><%= comment.user.username%></strong> <%= comment.body%></div>
                      </div>
                    <% end %>
                    <%= link_to 'See more...', post unless post.comments.count <= 3 %>
                  </div>
                </div>
                <button class="modal-close is-large toggle-modal" aria-control="comments<%=post.id%>"></button>
              </div>
            </div>
          </div>
        </div>
        <hr>
      <% end %>
    </div>
  </div>
  <div class="column is-3"></div>
</div>